<div class="dashboard-card">
  <header class="topbar">
    <div class="title">
      <h2>Store Dashboard</h2>
      <small *ngIf="storeId">Store ID: {{ storeId }}</small>
    </div>

    <div class="actions">
      <button class="btn" (click)="openStorePublic()">Open Store</button>
      <button class="btn primary" (click)="goAddProduct()">Add product</button>
      <button class="btn outline" (click)="triggerRefresh()">Refresh</button>
    </div>
  </header>

  <!-- summary tiles -->
  <section class="tiles">
    <ng-container *ngIf="totals$ | async as totals">
      <div class="tile">
        <div class="num">{{ totals.totalRevenue | number }}</div>
        <div class="label">Revenue</div>
      </div>
      <div class="tile">
        <div class="num">{{ totals.totalOrders }}</div>
        <div class="label">Orders</div>
      </div>
      <div class="tile">
        <div class="num">{{ totals.totalProducts }}</div>
        <div class="label">Products</div>
      </div>
    </ng-container>
  </section>

  <main class="content">
    <!-- analytics panel -->
    <aside class="analytics">
      <h3>Analytics</h3>
      <div *ngIf="analytics$ | async as analytics; else noAnalytics">
        <p>Total Revenue: {{ analytics.totalRevenue | currency }}</p>
        <p>Total Orders: {{ analytics.totalOrders }}</p>
        <p>Avg Order Value: {{ analytics.avgOrderValue | currency }}</p>
        <!-- يمكنك إضافة رسم بياني هنا -->
      </div>
      <ng-template #noAnalytics>
        <p>No analytics available.</p>
      </ng-template>
    </aside>

    <!-- main admin area: recent orders + products list, OR child routes render here -->
    <section class="admin-area">

      <!-- router outlet: صفحات الإدارة (products list, product form) ستظهر هنا كـ children -->
      <router-outlet></router-outlet>

      <!-- fallback / inline content when no child route rendered (dashboard default view) -->
      <div class="dashboard-default">
        <!-- recent orders -->
        <section class="orders">
          <h3>Recent Orders</h3>
          <table class="orders-table">
            <thead>
              <tr>
                <th>#</th>
                <th>Customer</th>
                <th>Items</th>
                <th>Total</th>
                <th>Status</th>
                <th>When</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <!-- <td>{{ i + 1 }}</td>
                <td>{{ o.user?.userName ?? o.user?.email ?? 'Guest' }}</td>
                <td>{{ o.items?.length ?? 0 }}</td>
                <td>{{ o.total | currency }}</td>
                <td>{{ o.status }}</td>
                <td>{{ o.createdAt | date:'short' }}</td> -->
              </tr>
            </tbody>
          </table>

          <ng-template #noOrders>
            <p>No recent orders.</p>
          </ng-template>
        </section>

        <!-- products summary -->
        <section class="products">
          <h3>Products</h3>
          <div>
            <div class="products-list">
              <div class="product-row">
                <!-- <img class="thumb" [src]="'/assets/placeholder.png'" alt="grger ge r" -->
                <!-- loading="lazy" /> -->
                <div class="meta">
                  <div class="title">ejygf dsif </div>
                  <div class="small">Price: 10</div>
                  <div class="small">Qty: 10</div>
                </div>
                <div class="controls">
                  <button class="btn outline small">Edit</button>
                  <button class="btn danger small">Delete</button>
                </div>
              </div>
            </div>
          </div>

          <ng-template #noProducts>
            <p>No products found.</p>
          </ng-template>
        </section>
      </div>

    </section>
  </main>
</div>